import{r as t,h as n,H as e,g as i}from"./p-8819b27a.js";import{RSListFoundation as r,RSList as u}from"@rsmdc/list/index";import{RSMenuSurfaceFoundation as o}from"@rsmdc/menu-surface/foundation";import{RSMenuSurface as s}from"@rsmdc/menu-surface/index";import{RSListFoundation as c}from"@rsmdc/list/foundation";var f=function(t,n){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function a(t,n){function e(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var h=function(){return(h=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function l(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var i,r,u=e.call(t),o=[];try{for(;(void 0===n||n-- >0)&&!(i=u.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(e=u.return)&&e.call(u)}finally{if(r)throw r.error}}return o}var d=function(){function t(t){void 0===t&&(t={}),this.adapter_=t}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}(),m=function(){function t(t,n){for(var e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];this.root_=t,this.initialize.apply(this,function(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(l(arguments[n]));return t}(e)),this.foundation_=void 0===n?this.getDefaultFoundation():n,this.foundation_.init(),this.initialSyncWithDOM()}return t.attachTo=function(n){return new t(n,new d({}))},t.prototype.initialize=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},t.prototype.getDefaultFoundation=function(){throw new Error("Subclasses must override getDefaultFoundation to return a properly configured foundation class")},t.prototype.initialSyncWithDOM=function(){},t.prototype.destroy=function(){this.foundation_.destroy()},t.prototype.listen=function(t,n){this.root_.addEventListener(t,n)},t.prototype.unlisten=function(t,n){this.root_.removeEventListener(t,n)},t.prototype.emit=function(t,n,e){var i;void 0===e&&(e=!1),"function"==typeof CustomEvent?i=new CustomEvent(t,{bubbles:e,detail:n}):(i=document.createEvent("CustomEvent")).initCustomEvent(t,e,!1,n),this.root_.dispatchEvent(i)},t}(),b={MENU_SELECTED_LIST_ITEM:"-selected",MENU_SELECTION_GROUP:"selectiongroup",ROOT:"rs-menu"},E={ARIA_SELECTED_ATTR:"aria-selected",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".rs-list",SELECTED_EVENT:"rsMenu:selected"},v=function(t){function n(e){var i=t.call(this,h({},n.defaultAdapter,e))||this;return i.closeAnimationEndTimerId_=0,i}return a(n,t),Object.defineProperty(n,"cssClasses",{get:function(){return b},enumerable:!0,configurable:!0}),Object.defineProperty(n,"strings",{get:function(){return E},enumerable:!0,configurable:!0}),Object.defineProperty(n,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},getParentElement:function(){return null},getSelectedElementIndex:function(){return-1},notifySelected:function(){}}},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.closeAnimationEndTimerId_&&clearTimeout(this.closeAnimationEndTimerId_),this.adapter_.closeSurface()},n.prototype.handleKeydown=function(t){("Tab"===t.key||9===t.keyCode)&&this.adapter_.closeSurface()},n.prototype.handleItemAction=function(t){var n=this,e=this.adapter_.getElementIndex(t);e<0||(this.adapter_.notifySelected({index:e}),this.adapter_.closeSurface(),this.closeAnimationEndTimerId_=setTimeout((function(){var i=n.getSelectionGroup_(t);i&&n.handleSelectionGroup_(i,e)}),o.numbers.TRANSITION_CLOSE_DURATION))},n.prototype.handleSelectionGroup_=function(t,n){var e=this.adapter_.getSelectedElementIndex(t);e>=0&&(this.adapter_.removeAttributeFromElementAtIndex(e,E.ARIA_SELECTED_ATTR),this.adapter_.removeClassFromElementAtIndex(e,b.MENU_SELECTED_LIST_ITEM)),this.adapter_.addClassToElementAtIndex(n,b.MENU_SELECTED_LIST_ITEM),this.adapter_.addAttributeToElementAtIndex(n,E.ARIA_SELECTED_ATTR,"true")},n.prototype.getSelectionGroup_=function(t){var n=this.adapter_.getParentElement(t);if(!n)return null;for(var e=this.adapter_.elementContainsClass(n,b.MENU_SELECTION_GROUP);!e&&n&&!this.adapter_.elementContainsClass(n,c.cssClasses.ROOT);)e=!!(n=this.adapter_.getParentElement(n))&&this.adapter_.elementContainsClass(n,b.MENU_SELECTION_GROUP);return e?n:null},n}(d),g=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a(n,t),n.attachTo=function(t){return new n(t)},n.prototype.initialize=function(t,n){void 0===t&&(t=function(t){return new s(t)}),void 0===n&&(n=function(t){return new u(t)}),this.menuSurfaceFactory_=t,this.listFactory_=n},n.prototype.initialSyncWithDOM=function(){var t=this;this.menuSurface_=this.menuSurfaceFactory_(this.root_);var n=this.root_.querySelector(E.LIST_SELECTOR);n?(this.list_=this.listFactory_(n),this.list_.wrapFocus=!0):this.list_=null,this.handleKeydown_=function(n){return t.foundation_.handleKeydown(n)},this.handleItemAction_=function(n){return t.foundation_.handleItemAction(t.items[n.detail.index])},this.afterOpenedCallback_=function(){return t.handleAfterOpened_()},this.menuSurface_.listen(o.strings.OPENED_EVENT,this.afterOpenedCallback_),this.listen("keydown",this.handleKeydown_),this.listen(r.strings.ACTION_EVENT,this.handleItemAction_)},n.prototype.destroy=function(){this.list_&&this.list_.destroy(),this.menuSurface_.destroy(),this.menuSurface_.unlisten(o.strings.OPENED_EVENT,this.afterOpenedCallback_),this.unlisten("keydown",this.handleKeydown_),this.unlisten(r.strings.ACTION_EVENT,this.handleItemAction_),t.prototype.destroy.call(this)},Object.defineProperty(n.prototype,"open",{get:function(){return this.menuSurface_.open},set:function(t){this.menuSurface_.open=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"wrapFocus",{get:function(){return!!this.list_&&this.list_.wrapFocus},set:function(t){this.list_&&(this.list_.wrapFocus=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"items",{get:function(){return this.list_?this.list_.listElements:[]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"quickOpen",{set:function(t){this.menuSurface_.quickOpen=t},enumerable:!0,configurable:!0}),n.prototype.setAnchorCorner=function(t){this.menuSurface_.setAnchorCorner(t)},n.prototype.setAnchorMargin=function(t){this.menuSurface_.setAnchorMargin(t)},n.prototype.getOptionByIndex=function(t){return t<this.items.length?this.items[t]:null},n.prototype.setFixedPosition=function(t){this.menuSurface_.setFixedPosition(t)},n.prototype.hoistMenuToBody=function(){this.menuSurface_.hoistMenuToBody()},n.prototype.setIsHoisted=function(t){this.menuSurface_.setIsHoisted(t)},n.prototype.setAbsolutePosition=function(t,n){this.menuSurface_.setAbsolutePosition(t,n)},n.prototype.setAnchorElement=function(t){this.menuSurface_.anchorElement=t},n.prototype.getDefaultFoundation=function(){var t=this;return new v({addClassToElementAtIndex:function(n,e){t.items[n].classList.add(e)},removeClassFromElementAtIndex:function(n,e){t.items[n].classList.remove(e)},addAttributeToElementAtIndex:function(n,e,i){t.items[n].setAttribute(e,i)},removeAttributeFromElementAtIndex:function(n,e){t.items[n].removeAttribute(e)},elementContainsClass:function(t,n){return t.classList.contains(n)},closeSurface:function(){return t.open=!1},getElementIndex:function(n){return t.items.indexOf(n)},getParentElement:function(t){return t.parentElement},getSelectedElementIndex:function(n){var e=n.querySelector("."+b.MENU_SELECTED_LIST_ITEM);return e?t.items.indexOf(e):-1},notifySelected:function(n){return t.emit(E.SELECTED_EVENT,{index:n.index,item:t.items[n.index]})}})},n.prototype.handleAfterOpened_=function(){var t=this.items;t.length>0&&t[0].focus()},n}(m);const p=class{constructor(n){t(this,n)}openeddHandler(){this.isOpened()}async isOpened(){this.opened?this.menu.classList.add("-opened"):this.menu.classList.remove("-opened")}componentDidLoad(){this.menu=this.el.shadowRoot.querySelector(".rs-menu"),this.rsMenu=new g(this.menu),this.isOpened()}render(){return n(e,null,n("div",{class:"rs-menu rs-menu-surface"},n("slot",null)))}get el(){return i(this)}static get watchers(){return{opened:["openeddHandler"]}}static get style(){return"STYLE_TEXT_PLACEHOLDER:rs-menu"}};export{p as rs_menu};